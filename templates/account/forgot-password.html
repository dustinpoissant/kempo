<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="icon" type="image/png" sizes="48x48" href="../media/icon48.png">
	<link rel="manifest" href="../manifest.json" />
	<title>Forgot Password</title>
	<link rel="stylesheet" href="../kempo-css/kempo.min.css">
	<script>window.litDisableBundleWarning = true;</script>
</head>
<body>
	<k-import src="../nav-1.inc.html"></k-import>
	<main class="p">
		<div style="max-width: 600px; margin: 0 auto;">
			<h2>Forgot Password</h2>
			<p>Enter your email address and we'll send you a link to reset your password.</p>
			<form id="forgotPasswordForm">
				<label>Email</label>
				<input type="email" id="email" required />
				<button type="submit" class="p-sm br mt">Send Reset Link</button>
			</form>
			<div id="message" class="mt" style="display: none;"></div>
			<p class="mt">
				Remember your password? <a href="/account/login">Login</a>
			</p>
		</div>
	</main>
	<script src="https://cdn.jsdelivr.net/npm/kempo-ui@0.0.42/dist/components/Import.js" type="module"></script>
	<script type="module">
		import { forgotPassword } from '../kempo/auth.js';

		const form = document.getElementById('forgotPasswordForm');
		const emailInput = document.getElementById('email');
		const messageDiv = document.getElementById('message');

		form.addEventListener('submit', async (e) => {
			e.preventDefault();
			
			const submitBtn = form.querySelector('button[type="submit"]');
			submitBtn.disabled = true;
			submitBtn.textContent = 'Sending...';

			try {
				await forgotPassword({ email: emailInput.value });
				
				messageDiv.className = 'mt p br bg-success c-white';
				messageDiv.textContent = 'Password reset link sent! Check your email.';
				messageDiv.style.display = 'block';
				
				form.style.display = 'none';
			} catch(error) {
				messageDiv.className = 'mt p br bg-danger c-white';
				messageDiv.textContent = error.message || 'Failed to send reset link';
				messageDiv.style.display = 'block';
				
				submitBtn.disabled = false;
				submitBtn.textContent = 'Send Reset Link';
			}
		});
	</script>
</body>
</html>
